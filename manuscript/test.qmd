---
title: "The role of cognateness in non-native spoken word recognition"
link-citations: true
editor: source
lang: en
freeze: true
fig-dpi: 1000
echo: false
warning: false
format: pdf
csl: "_assets/apa7.csl"
bibliography: "_assets/references.bib"
---

```{r}
#| label: setup
#| message: false
#| warning: false
#| include: false

library(targets)
library(dplyr)
library(tidyr)
library(ggplot2)
library(patchwork)
library(gt)
library(gtExtras)
library(brms)
library(tidybayes)

set.seed(1234)

# import objects
tar_config_set(store = here::here("_targets"),
               script = here::here("_targets.R"))
tar_load_globals()
tar_load(participants)
tar_load(exp_participants)
tar_load(exp_responses)
tar_load(quest_responses)
tar_load(quest_participants)
tar_load(stimuli)
tar_load(epreds)
tar_load(dataset_1)
tar_load(dataset_2)
tar_load(dataset_3)
tar_load(exp_1_m0)
tar_load(exp_2_m0)
tar_load(exp_3_m0)
tar_load(exp_1_loos)
tar_load(exp_2_loos_1)

theme_set(theme_ggdist() + 
              theme(panel.grid.major.y = element_line(colour = "grey",
                                                      linetype = "dotted")))

```


# Introduction

Listening to non-native speech is costlier than listening to native speech, even for highly proficient bilinguals, and especially in acoustically adverse situations [@lecumberri2010non; @takata1990english]. However, there are some sources of information which may make non-native speech comprehension easier. One of the sources of this increased difficulty stems from the possible mismatch between the phonology of the native and the non-native languages: some acoustic features embedded in the non-native speech signal do not overlap perfectly with any phonemic category in the listener's native language. For example, imagine a Spanish native, with no previous familiarity with any other language, who listens for the first time to French may encounter the word /`r knitr::asis_output("\U0070\U0254\U0281\U0074")`/ (*porte*), translation of door in French. The voiced uvular fricative consonant /`r knitr::asis_output("\U0281")`/ and the open-mid back rounded vowel /`r knitr::asis_output("\U0254")`/ do not exist in Spanish as phonemic categories. These discrepancies can nonetheless be perceived as allophonic variations the native (Spanish) phonemes /r/ and /o/ [@best2001discrimination], and the non-native speech signal may engage lexical processing mechanisms [@weber2004lexical], leading to the activation and selection, and therefore the recognition of its translation to Spanish /`r knitr::asis_output("\U02C8\U0070\U0077\U0065\U0072\U002E\U0074\U0061")`/ (*puerta*). The recognition of this French, unfamiliar word relies almost entirely on its similarity with its Spanish translation. Conversely, imagine now that the same Spanish listener hears English for the first time and encounters the word /`r knitr::asis_output("\U0064\U0254\U02D0")`/ (*door*). This time, phonological similarity is of little help: /`r knitr::asis_output("\U02C8\U0070\U0077\U0065\U0072\U002E\U0074\U0061")`/ and /`r knitr::asis_output("\U0064\U0254\U02D0")`/ share very few phonemes. It would come as a surprise if the listener was able to translate the English word successfully, if not by relying on previously learnt word-concept associations (which they lack, as they are unfamiliar to English).

Cross-language phonological similarity seems, at face value, an important source of information for unfamiliar listeners during auditory word recognition, even if translations are not phonologically identical. Although this mismatch has a noticeable toll on comprehension [@cutler2004patterns], the fact that word recognition can take place at all in such circumstances illustrates that non-native listeners–even low-proficiency ones–are rarely completely naïve to the language they are listening to. In the present study, we investigate the extent to which adult listeners rely on the phonological similarity between their native and non-native languages during word recognition, capitalising on the role of *cognates.*

Many languages share, to some extent, similarities at the lexical level. This is frequently due to their typological closeness and/or socio-historical events involving the speakers of these languages (e.g., migration, social contact). Cognates embody a particular case of such commonalities. Cognates are defined as cross-language synonyms which have similar forms whose form is similar (at the phonological level, orthographic level, signed level), commonly due to their shared etymological origin^[Some form-similar cross-language synonyms are technically not cognates. For example, *sun* and *sol* (in Spanish) share phonological onset but their etymology points to different origins. The complimentary case is equally problematic when defining cognateness: cross-language synonyms that share etymological origin may not be necessarily be recognised as cognates by the average listener. Such is the case of *cheese* and *queso* which share Latin root but are phonologically dissimilar. For simplicity, we will use the term *cognateness* in this paper to include all cross-language synonyms that fulfill a specified threshold of form similarity, regardless of etymology. We do not expect that etymology plays a direct role on language perception if it is not via form-similarity, since it is not necessary for participants in psycholinguistic experiments to be aware of the etymology of the words they encounter in the tasks to be subject to the effect of form-similarity.]. For example, Romance languages such as Spanish and Catalan share many cognates [@schepens2012distributions], as in the case of *puerta* and *porta* (door in Spanish and Catalan, respectively). Cognates play a pivotal role in many models of bilingual lexical processing because they provide evidence that bilinguals access the lexicon in a language non-selective way. For instance, pictures are named faster by Spanish-Catalan bilinguals when their associated labels in both languages are cognates (e.g., *puerta*-*porta*), compared to when their labels are non-cognates (*mesa*-*taula*, [table]), which suggests that word representations of both languages are activated during word retrieval [@costa2000cognate]. This cognate advantage is not restricted to production, but also extends to word recognition [@thierry2007brain; @midgley2011effects], word learning [@de2000hard; @lotto1998effects; @valente2018does; @elias2022cross], and word translation [@christoffels2006memory].

## Lexical and conceptual routes for translation

Early theoretical accounts of this 'Cognate effect' proposed that the impact of cognateness on lexical processing depends on bilinguals' proficiency in their second language (L2) [@potter1984lexical; see @chen1989patterns for similar results]. The reasoning behind this claim was the assumption that second-language learners start acquiring words in their L2 by associating them to their translation in their L1 (lexical route), instead of directly to their shared concept (conceptual route). This word-to-word connectivity should be sensitive to form-similarity (i.e., cognateness): the more similar the two word- forms are, the stronger the connection. As learners become more proficient, the connection between L2 representations and their meaning grows stronger, and L2 word processing becomes less reliant on word-word connections between L1 and L2 representations. Cognates subsequently exert less impact on lexical processing in proficient speakers [see @andras2022cognate for recent experimental evidence for this claim]. The Revised Hierarchical Model [RHM, @kroll1994category] captured this hypothesis and predicted that translating words from L1 to L2 should take longer than translating from L2 to L1. The rationale behind this prediction was that L1-to-L2 translation relies more strongly on word-to-word links between L1 and L2 representations, where L2-to-L1 translation relies more strongly on the mediation between the concept and the two word- forms. L1-to-L2 translation should therefore be more sensitive to the form similarity between the L1 and the L2 representations: cognate words should be retrieved faster than non-cognate words during L1-to-L2 translation.

To test these predictions, @degroot1994forward and @de1992determinants asked Dutch natives with high (but non-native) English proficiency to translate Dutch words to English (L1-to-L2) or English words to Dutch (L2-to-L1). Although participants' performance in both conditions was roughly equivalent for cognates, non-cognates were translated more slowly from Dutch to English than from English to Dutch, suggesting that L1-to-L2 translation is more sensitive to form-similarity than L2-to-L1 translation. Conversely, participants' performance was more sensitive to semantic variables (e.g., concreteness) when translating English words to Dutch, compared to when translating Dutch words to English, suggesting that L2-to-L1 translation was more sensitive to the shared conceptual properties of the translation pair.

These findings support a soft version of the RHM model, in which both the conceptual and the lexical translation routes are active during translation, but where L1-to-L2 translation relies more strongly on word-to-word links between L1 and L2 representations than L2-to-L1 translation does, and therefore is more sensitive to cognateness. Further evidence for the presence of this difference between L1-to-L2 and L2-to-L1 translations on the degree of reliance on the lexical and or the conceptual routes between L1-to-L2 and L2-to-L1 translation was provided by @phillips2006erp, who used eletrophysiological recordings of bilinguals translating words from L1 to L2 or *vice versa* after semantic or phonological priming. The authors reported stronger N400 responses (associated with semantic priming) in L1-to-L2 translation than in L2-to-L12 translation, and stronger phonological mismatch negativity responses (associated with phonological priming) during L2-to-L1 translation, compared to L1-to-L2 translation.

## Competition from lexical neighbours

Since the RHM model was proposed, later studies on monolingual populations have focused how on the role of the network of connections that words establish networks of connections with each other at the form-level (phonological or orthographic) or at the conceptual level. For instance, the Neighbourhood Activation Model [NAM, @luce1998recognizing] highlighted how lexical selection is affected by the number of phonological neighbours that the selected word has. Words surrounded by a larger number of phonological neighbours (words that only differ in one phoneme from the target word) are responded to more slowly and less accurately than words from sparser phonological neighbourhoods [@goldinger1989priming; @luce1990similarity], especially when these neighbours' lexical frequency is higher [@luce1998recognizing]. 

The existence of phonological links between words is supported with experimental evidence from the visual world paradigm and phonological priming. @meyer2007activation showed that target pictures were named faster when presented together with a phonologically-related distractor, suggesting that the activation of shared phonological information allowed the target to be activated and produced faster. there are also findings suggesting that facilitatory or inhibitory effects on target recognition depend on the degree of similarity the competitor shares with the target [@hamburger1996phonological; @dufour2003lexical]. When there is only mismatch of one phoneme between prime and target, inhibitory effects are exerted on target recognition [@dufour2003lexical]. This inhibition was proposed to be due to strong lexical activation of the prime which results in lexical interference, as opposed to simple phonological activation from less similar primes that triggers facilitation.

These findings of phonological links between words in the monolingual lexicon pose an important question in the field of bilingualism research: do word representations in one language form part of the phonological or orthographic neighbours of the other language? @weber2004lexical observed that bilinguals displayed lexical competition effects from words in their native language when performing a word-referent matching task in their L2. This highlights that lexical competition for bilinguals during language comprehension may not only come from the tested language but also the native language, despite the native language not being actively required for the task. Other studies have similarly found interference when spoken target words in one language had phonological overlap with a word in the participant's other language, even when the other language was not required by the task [@spivey1999cross; @desroches2022dynamics]. Such patterns have even been found with young children less than 4 years old [@von2012language].

The Bilingual Interactive Activation (BIA/BIA+) [@van1998orthographic; @dijkstra2002architecture] addressed this issue and suggested that lexical representations from both languages establish both excitatory and inhibitory connections with each other, resulting in an integrated lexicon for both languages. This is, in line with connectionist approaches to lexical processing [@mcclelland1981interactive]. Evidence supporting such an integrated lexicon is provided by the fact that bilinguals' performance in word recognition tasks is sensitive to the orthographic neighbourhood density of the presented word's translation. When bilingual participants are presented with words in one language in a lexical decision task, translating them to the other language took longer when they were part of large neighbourhoods [@van1998orthographic]. This suggests that presented words activated orthographic neighbourhoods in the other language, which competed for selection with the target word during recognition. 


## The present study

In the present study, we tested listeners' reliance on phonological similarity when translating words from an unfamiliar language to their native language, in order to investigate the plausibility of word-to-word connections during L1-to-L2 translation. We tested English native speakers and Spanish native speakers in a translation elicitation task. This paradigm has been used by bilingualism researchers to identify easily-recognisable cognates for experimental studies. Using this paradigm, we aim to delve deeper into the factors affecting foreign word recognition by monolingual participants with no prior exposure to the language.

Participants were presented with spoken words in an unfamiliar (non-native language) and were asked to translate them to their native language. We will henceforth refer to the auditory-presented words heard by participants on each trial as presented words, and the correct translation for the presented words as target translations. The motivation behind testing participants in an unfamiliar language was that these participants can be considered a particular (extreme) case of unbalanced bilingualism, in which they do not know any words in L2, and therefore word-to-concept connections are, in principle, absent. As a consequence, these participants should only be able use word-to-word connections to succeed in the translation of words in an unfamiliar language. We predicted that, if the information provided by the phonological form of the unfamiliar presented words is sufficient for translation, participants' performance should increase when the translation pairs are phonologically more similar.

Following @luce1998recognizing's NAM model, we further hypothesised that if participants are able to correctly translate words from an unfamiliar language based on their phonological similarity to the target word, similar sounding but incorrect translations (e.g., false friends) should be activated too. If this is the case, non-native words that have more phonological neighbours should be less likely to be correctly translated, especially if such neighbours have higher lexical frequency and are phonologically closer to the presented word than the target translation. For instance, one could expect English participants to incorrectly translate the Spanish word *botón* as bottom instead of as its correct translation *button* (because the lexical frequency of *bottom* is higher than that of *button* and also phonological closer). This combined constraint led us to calculate a specific form of phonological neighbours where a neighbour is counted only if it is higher frequency and has stronger phonological similarity than the target translation as judged by Levenshtein distance. If the phonological neighbourhood density of the target translation affects participants' performance negatively, this would suggest that non-native words trigger competition between words in the native language during translation.

In Experiment 1, we collected data from two groups of British English natives. One group was presented with Catalan words, the other with Spanish words. We examined the extent to which participants were able to use the phonological similarity between the presented (Catalan or Spanish) word and its translation (i.e., cognateness) to provide accurate responses. In Experiment 2, we tested a group of (European) Spanish natives in the same task, who were presented with Catalan words. Catalan and Spanish are both Romance languages whose close typological distance is reflected in the fact that they share many cognates, where English is a Germanic language that shares considerably fewer cognates with Catalan and Spanish. By testing participants translating words from typologically close and distant languages, we expected to widen the range of the phonological similarity scores of the translation pairs involved in the experimental task, therefore allowing us to explore potential cross-language differences in participant's performance. Participants in Experiments 1 and 2 were surprisingly good at translation some words, which had low phonological similarity with their correct translation. In Experiment 3, we collected additional data from a new group of British English natives, who were presented with Catalan and Spanish words. In contrast with the procedure in Experiment 1, participants in Experiment 3 where asked, after providing a response in each trial, to report whether they had previous knowledge of the meaning of the presented word (e.g., some Spanish words are common knowledge, even for monolingual speakers of English). Finally, we present analyses on the joint data sets of Experiments 1 to 3.


# Experiment 1

## Methods

All materials, data, and code used in this study are hosted in the Open Science Framework [https://osf.io/9fjxm/](https://osf.io/9fjxm/) and a GitHub repository [https://github.com/gongcastro/translation-elicitation.git](https://github.com/gongcastro/translation-elicitation.git), along with additional notes.


### Participants

```{r}
#| label: participants-numbers-1
participants_1 <- exp_participants |> 
    filter(group!="cat-SPA")

collection_dates <- participants_1 |> 
    pull(date) |> 
    range() |> 
    format("%B %dth, %Y")

n_participants <- n_distinct(participants_1)
n_participants_group <- table(participants_1$group)
participants_age <- participants_1 |> 
    summarise(across(age, lst(mean, sd, min, max))) 
n_female <- table(participants_1$gender)
```

Data collection took place from `r collection_dates[1]` to `r collection_dates[2]`. We collected data from `r n_participants` British English native participants living in United Kingdom (*Mean* = `r round(participants_age$age_mean, 2)` years, *SD* = `r round(participants_age$age_sd, 2)`, Range = `r round(participants_age$age_min, 2)`-`r round(participants_age$age_max, 2)`, `r n_female` female). 

```{r tbl-participants}
#| label: tbl-participants
#| eval: false
tbl_data <- participants |> 
    mutate(exp = case_when(
        source=="Experiment" & group!= "cat-SPA" ~ "Experiment 1",
        source=="Experiment" & group== "cat-SPA" ~ "Experiment 2",
        source=="Questionnaire" ~ "Experiment 3",
    )) |> 
    summarise(n = n(),
              n_excluded = sum(!valid_status=="Valid"),
              across(age, lst(mean, sd, min, max)),
              knows_l2 = sum(l2 != "None"),
              l2_lst = lst(unique(l2)[unique(l2)!="None"]),
              .by = c(group, exp)) 

tbl_data |> 
    gt(groupname_col = "exp", rowname_col = "group") |> 
    fmt_number(matches("age")) |> 
    fmt_integer(matches("min|max")) |> 
    cols_merge_range(age_min, age_max) |> 
    tab_spanner("Age", matches("age")) |> 
    tab_spanner("Sample size", starts_with("n")) |> 
    tab_spanner("L2", matches("l2")) |> 
    cols_label(group = "Group",
               exp = "Experiment",
               n = "N",
               n_excluded = "Excluded",
               age_mean = "M",
               age_sd = "SD",
               age_min = "Range",
               knows_l2 = "N knows L2?",
               l2_lst = "Which L2?") |> 
    tab_style(cell_text(style = "italic"),
              cells_column_labels()) |> 
    tab_style(cell_text(weight = "bold"),
              cells_column_spanners()) |> 
    tab_style(cell_text(align = "left"),
              list(cells_body(), cells_column_labels()))
```


```{r}
#| label: participants-excluded-1
excluded_lang <- participants_1 |> 
    filter(l2_writ_prod > 3 |
               l2_oral_comp > 3 |
               cat_oral_comp > 3 | 
               cat_writ_prod > 3 |
               spa_oral_comp > 3 |
               spa_writ_prod > 3) |> 
    nrow()

excluded_impairment <- participants_1 |> 
    filter(valid_status=="Language impairment") |> 
    nrow()

excluded_ntrials <- participants_1 |> 
    filter(valid_status=="Insufficient trials") |> 
    nrow()
```

Participants were recruited via Prolific (5£ compensation) and SONA (compensation in academic credits), and gave informed consent before providing any data and the study was conducted in accordance with ethical standards of the Declaration of Helsinki and the protocol was by the University of Oxford Medical Sciences Inter-Divisional Research Ethics Committee (IDREC) (R60939/RE007). Participants were asked to complete the experiment using a laptop in a quiet place with good internet connection. We excluded data from participants that (a) self-rated their oral and/or written skills in Catalan and Spanish, or any other second language as four or higher in a five-point scale (*n* = `r excluded_lang`), (b) were diagnosed with a language (*n* = `r excluded_impairment`), or (c) did not contribute more than 80% of valid trials (*n* = `r excluded_ntrials`).

### Stimuli

```{r}
#| label: stimuli-lengths
lengths <- stimuli |>  
    select(group, ipa_flat_1, ipa_flat_2, word_1, word_2) |>  
    mutate(across(ipa_flat_1:word_2, nchar)) |> 
    summarise(across(c(ipa_flat_1, ipa_flat_2, word_1, word_2), 
                     lst(mean, sd, min, max)),
              .by = group)
lengths <- split(lengths, lengths$group)
names(lengths) <- janitor::make_clean_names(names(lengths))

durations <- stimuli |> 
    summarise(across(duration, lst(mean, sd, min, max)),
              .by = group) 
durations <- split(durations, durations$group)
names(durations) <- janitor::make_clean_names(names(durations))
```

We arranged two lists of input words to be presented to participants in the auditory modality: one in Catalan and one in Spanish. Words in the Catalan list were `r round(lengths$cat_eng$ipa_flat_1_mean, 2)` phonemes long on average (*SD* = `r round(lengths$cat_eng$ipa_flat_1_sd, 2)`, *Range* = `r round(lengths$cat_eng$ipa_flat_1_min, 2)`-`r round(lengths$cat_eng$ipa_flat_1_max, 2)`), and the orthographic form of their English translations (which participants had to type), were `r round(lengths$cat_eng$word_2_mean, 2)` characters long on average (*SD* = `r round(lengths$cat_eng$word_2_sd, 2)`, *Range* = `r round(lengths$cat_eng$word_2_min, 2)`-`r round(lengths$cat_eng$word_2_max, 2)`. Words in the Spanish list were `r round(lengths$spa_eng$ipa_flat_1_mean, 2)` phonemes long on average (*SD* = `r round(lengths$spa_eng$ipa_flat_1_sd, 2)`, *Range* = `r round(lengths$spa_eng$ipa_flat_1_min, 2)`-`r round(lengths$spa_eng$ipa_flat_1_max, 2)`), and the orthographic form of their English translations (which participants had to type), were `r round(lengths$spa_eng$word_2_mean, 2)` characters long on average (*SD* = `r round(lengths$spa_eng$word_2_sd, 2)`, *Range* = `r round(lengths$spa_eng$word_2_min, 2)`-`r round(lengths$spa_eng$word_2_max, 2)`.

Participants listened to one audio file in each trial, each containing a single word presented in isolation. The audio files were the same ones used in child experiments conducted in the Laboratori de Recerca en Infància of Universitat Pompeu Fabra (Barcelona, Spain). These audio files were recorded by a proficient Catalan-Spanish female bilingual from the Metropolitan Area of Barcelona in a child-directed manner. Catalan and Spanish words were recorded at 44,100 Hz in separate files in the same session, and then de-noised using Audacity and normalised at peak intensity using Praat [@broersma2021praat]. The average duration of the Catalan audio files was `r round(durations$cat_eng$duration_mean, 2)` (*SD* = `r round(durations$cat_eng$duration_sd, 2)`, *Range* = `r round(durations$cat_eng$duration_min, 2)`-`r round(durations$cat_eng$duration_max, 2)`). The average duration of the Catalan audio files was `r round(durations$spa_eng$duration_mean, 2)` (*SD* = `r round(durations$spa_eng$duration_sd, 2)`, *Range* = `r round(durations$spa_eng$duration_min, 2)`-`r round(durations$spa_eng$duration_max, 2)`).


```{r}
stim_exc_freq <- stimuli |> 
    mutate(is_na = is.na(freq_zipf_2)) |> 
    count(group, is_na) |> 
    filter(is_na)
stim_exc_freq <- split(stim_exc_freq, stim_exc_freq$group)
names(stim_exc_freq) <- janitor::make_clean_names(names(stim_exc_freq))

stim_exc_freq_n <- sum(map_int(stim_exc_freq, "n"))
```

For each translation pair, we defined three predictors of interest: the lexical frequency of the correct translation (*Frequency*), the phonological similarity between the presented (Catalan or Spanish) word and their correct English translation (*Cognateness*), and presented word's number of cross-language phonological neighbours (*CLPN*).

We included *Frequency* under the hypothesis that, keeping other predictors constant, participants would translate higher-frequency words more accurately and faster than lower-frequency words. Lexical frequencies of correct translations were extracted from SUBTLEX-UK [@van2014subtlex], and transformed to Zipf scores [@van2014subtlex]. Words in the stimuli list without a lexical frequency value were excluded from data analysis (`r stim_exc_freq$cat_eng$n` in the Catalan list, `r stim_exc_freq$spa_eng$n` in the Spanish list).

We calculated *Cognatenesss*, our main predictor of interest, by computing the Levenshtein similarity between the X-SAMPA transcriptions of each pair of translations using the `stringdist` R package [@van2014stringdist]. The Levenshtein distance computes the edit distance between two character strings (in this case, phoneme transcriptions) by counting the number of additions, deletions, and substitutions necessary to make both strings identical [@levenshtein1966binary]. We divided this edit distance by the number of characters included in the longest X-SAMPA transcription of the translation pair. This results in a proportion score, in which values closer to zero correspond to lower Levenshtein distances between phonological transcriptions (i.e., higher similarity), and values closer to 1 correspond to higher Levenshtein distances (i.e., lower similarity). This transformation also help account for the fact that the Levenshtein distance tends to increase with the length of the transcriptions. For interpretability, we subtracted this proportion from one, so that values closer to one correspond to higher similarity between phonological transcriptions, and values closer to zero correspond to lower similarity between phonological transcriptions. For example, the *table* (teɪbəl)-*mesa* (mesa) translation pair had a `r scales::percent(stringsim(enc2utf8("teɪbəl"), enc2utf8("mesa")))` similarity, while the *train* (trEIn)-*tren* (t`r knitr::asis_output("\U027E")`En) translation pair had a `r scales::percent(stringsim(enc2utf8("trEIn"), enc2utf8("tɾEn")))` similarity. Figure 1 summarises the lexical frequency, phonological neighbourhood density and phonological overlap of the words included in the Catalan and the Spanish lists.

For each Catalan and Spanish word, we calculated the number of *CLPN* by counting the number of English words with same or higher lexical frequency, and whose phonological transcription (in X-SAMPA format) different in up to one phoneme from that of the presented Catalan or Spanish word. Lexical frequencies and phonological transcriptions were extracted from the multilingual database CLEARPOND [@marian2012clearpond]^[[Phonological trnascriptions in CLEARPOND were generated from eSPEAK, [http://espeak.sourceforge.net/](http://espeak.sourceforge.net/)]].


```{r tbl-stimuli}
#| label: tbl-stimuli
#| eval: false
stimuli |> 
    summarise(across(c(freq_zipf_2, lv, neigh_n_h),
                     lst(mean, median, sd, min, max), 
                     na.rm = TRUE),
              .by = c(group)) |> 
    gt(rowname_col = "group") |> 
    tab_spanner("Frequency", matches("freq")) |> 
    tab_spanner("Cognateness", matches("lv")) |> 
    tab_spanner("CLPN", matches("neigh")) |> 
    fmt_number(is.numeric) |> 
    fmt_integer(c(neigh_n_h_median,
                  neigh_n_h_min,
                  neigh_n_h_max)) |> 
    cols_merge_uncert(freq_zipf_2_mean, freq_zipf_2_sd) |> 
    cols_merge_uncert(lv_mean, lv_sd) |> 
    cols_merge_uncert(neigh_n_h_mean, neigh_n_h_sd) |> 
    cols_merge_range(freq_zipf_2_min, freq_zipf_2_max) |> 
    cols_merge_range(lv_min, lv_max) |> 
    cols_merge_range(neigh_n_h_min, neigh_n_h_max) |> 
    cols_label(freq_zipf_2_mean = "Mean",
               freq_zipf_2_sd = "SD",
               freq_zipf_2_median = "Median",
               freq_zipf_2_min = "Range",
               lv_mean = "Mean",
               lv_sd = "SD",
               lv_median = "Median",
               lv_min = "Range",
               neigh_n_h_mean = "Mean",
               neigh_n_h_sd = "SD",
               neigh_n_h_median = "Median",
               neigh_n_h_min = "Range") |> 
    tab_style(cell_text(weight = "bold"),
              cells_column_spanners()) |> 
    tab_style(cell_text(style = "italic"),
              cells_column_labels())

```



### Procedure

The experiment was implemented online using Psychopy/Pavlovia [@peirce2019psychopy2]. Participants accessed the study from a link provided by Prolific or SONA and completed the experiment from an internet browser (Chrome or Mozilla). After giving their consent for participating, participants answered a series of questions about their demographic status, their language background, and the set up they were using for completing the study. Then, participants completed the experimental task. Participants were informed that they would listen to a series of pre-recorded words in either Catalan or Spanish (English participants) or Catalan (Spanish participants). They were instructed to listen to each word, guess its meaning in English (English participants) or Spanish (Spanish participants), and type their answer as soon as possible. English participants were randomly assigned to the Catalan or Spanish lists. Participants in the Catalan list were presented with `r nrow(stimuli[stimuli$group=="cat-ENG",])` trials, and participants in the Spanish list were presented with `r nrow(stimuli[stimuli$group=="spa-ENG",])` trials.

Each trial started with a yellow fixation point presented during one second on the centre of the screen over a black background. After one second, the audio started playing while the dot remained being displayed until the audio ended. Upon the offset of the fixation point and audio, participants were prompted to write their answer by a `>` symbol. Typed letters were displayed in the screen in real time to provide visual feed-back to participants. Participants were allowed to correct their answer. Then, participants pressed the `RETURN/ENTER` key to confirm their answer and start and new trial. We excluded trials where the participant's answer was not a valid word in the target language or no answer was given. Trials in which the response was mistyped by only one character were counted as correct (e.g., "pengiun" instead of "penguin"), as long as the response did not correspond to a distinct word. Trials in which participants took longer than 10 seconds to respond were also excluded. Participants contributed a total of `r nrow(exp_responses)` valid trials (`r nrow(exp_responses[exp_responses$group %in% c("cat-ENG", "cat-SPA"),])` in Catalan, `r nrow(exp_responses[exp_responses$group %in% c("spa-ENG"),])` in Spanish). The task took approximately 15 minutes to be completed.



```{r}
#| label: procedure-figure
#| echo: false
#| message: false
#| warning: false
#| eval: false
#| out-width: "80%"
#| fig-cap: "Schematic representation of a trial in the experimental task."
knitr::include_graphics(here::here("img", "design.png"))
```




### Data analysis

```{r}
lengths <- dataset_1 |> 
    mutate(len = nchar(response)) |> 
    summarise(across(len,
                     lst(mean, median, sd, min, max)),
              .by = c(group)) 
lengths <- split(lengths, lengths$group)

names(lengths) <- janitor::make_clean_names(names(lengths))
```

Responses given by English participants to Catalan presented words were `r round(lengths$cat_eng$len_mean, 2)` characters long on average (*Median* = `r round(lengths$cat_eng$len_median, 2)`, *SD* = `r round(lengths$cat_eng$len_sd, 2)`, Range = `r round(lengths$cat_eng$len_min, 2)`-`r round(lengths$cat_eng$len_max, 2)`), while their translations to Spanish responses were `r round(lengths$spa_eng$len_mean, 2)` characters long on average (*Median* = `r round(lengths$spa_eng$len_median, 2)`, *SD* = `r round(lengths$spa_eng$len_sd, 2)`, Range = `r round(lengths$spa_eng$len_min, 2)`-`r round(lengths$spa_eng$len_max, 2)`).

```{r}
#| label: tbl-results
#| eval: false
tbl_data <- list("Experiment 1" = dataset_1,
                 "Experiment 2" = dataset_2,
                 "Experiment 3" = dataset_3) |> 
    bind_rows(.id = "exp") |> 
    count(exp, group, response_type) |> 
    pivot_wider(names_from = response_type,
                values_from = n,
                names_repair = janitor::make_clean_names) |>
    relocate(exp, group, correct, typo, wrong, false_friend) |> 
    mutate(n_correct = rowSums(cbind(correct, typo)),
           n_incorrect = rowSums(cbind(wrong, false_friend)),
           n_total = rowSums(cbind(n_correct, n_incorrect)),
           across(correct:false_friend, 
                  \(x) x / n_total,
                  .names = "{col}_prop")) |> 
    select(exp, group, correct, typo, wrong, false_friend,
           matches("prop"))


tbl_data |> 
    gt(rowname_col = "group", groupname_col = "exp") |> 
    fmt_missing(everything(), everything(), "--") |> 
    tab_spanner("Correct responses", 
                c(correct, typo)) |> 
    tab_spanner("Incorrect responses", 
                c(wrong, false_friend)) |> 
    fmt_integer(c(correct, typo, wrong, false_friend)) |> 
    fmt_percent(is.double) |> 
    cols_merge_n_pct(correct, col_pct = correct_prop) |> 
    cols_merge_n_pct(typo, col_pct = typo_prop) |> 
    cols_merge_n_pct(wrong, col_pct = wrong_prop) |> 
    cols_merge_n_pct(false_friend, col_pct = false_friend_prop) |> 
    
    cols_label(correct = "Correct",
               typo = "Typo",
               wrong = "Wrong translation",
               false_friend = "False friend") |> 
    tab_style(cell_text(weight = "bold"), 
              cells_column_spanners()) |> 
    tab_style(cell_text(style = "italic"), 
              cells_column_labels())

```



We modelled the probability of participants guessing the correct translation of each presented word using a generalised multilevel Bayesian regression model with a Bernoulli logit link distribution. We included as fixed effects the intercept, the main effects of *Frequency*, *Cognateness*, and *CLPN*, and the two-way interaction between *Cognateness* and *CLPN*. We also included participant-level random intercepts and slopes for the the main effects and the interaction. @eq-model shows a formal description of the model.

To test the practical relevance of each predictor we followed [@krushke2018bayesian]. We first specified a region of practical equivalence (*ROPE*) around zero. This area indicates the values of the regression coefficients that we considered as equivalent to zero. We then computed the 95% posterior credible intervals (CrI) of the regression coefficients of interest. Finally, we calculated the proportion of the 95% CrI that fell inside the ROPE. This proportion indicates the probability that the true value of the coefficient is equivalent to zero. 

All analyses were performed in R environment [@rcore2019r]. We used the tidyverse family of R packages [@wickham2019tidyverse] to process data and to generate figures. We used the `brms` R package [@burkner2017brms] using the `cmdstanr` back-end to the Stan probabilistic language [@carpenter2017stan] to estimate and compare the models (see Appendix 1 for mode details on the models).


## Results

```{r}
c1 <- gather_draws(exp_1_m0, `b_.*`, `sd_.*`, regex = TRUE) |> 
    summarise(across(.value, lst(.median = median, 
                                 .lower = \(x) hdi(x)[1],
                                 .upper = \(x) hdi(x)[2],
                                 .rope = \(x) mean(between(x, -0.1, 0.1))),
                     .names = "{fn}"))
c1 <- split(c1, c1$.variable)
names(c1) <- janitor::make_clean_names(names(c1)) 
```

@tbl-results-1 shows a summary of participants' accuracy across Experiments 1, 2, and 3. Overall, participants responded less accurately to words with more CLPNs than to words with fewer CLPNs, regardless of the amount of phonological similarity between the presented word and its translation. This is indicated by the size of the regression coefficient of the two-way interaction between *Cognateness* and *CLPN* ($\beta$ = `r round(c1$b_neigh_n_h_lv$.median, 3)`, 95% CrI = [`r round(c1$b_neigh_n_h_lv$.lower, 3)`, `r round(c1$b_neigh_n_h_lv$.upper, 3)`], *p*(ROPE) = `r round(c1$b_neigh_n_h_lv$.rope, 3)`). As anticipated, participants' performance benefited from an increase in *Cognateness* ($\beta$ = `r round(c1$b_lv$.median, 3)`, 95% CrI = [`r round(c1$b_lv$.lower, 3)`, `r round(c1$b_lv$.upper, 3)`], *p*(ROPE) = `r round(c1$b_lv$.rope, 3)`), while the number of *CLND* had the opposite effect ($\beta$ = `r round(c1$b_neigh_n_h$.median, 3)`, 95% CrI = [`r round(c1$b_neigh_n_h$.lower, 3)`, `r round(c1$b_neigh_n_h$.upper, 3)`], *p*(ROPE) = `r round(c1$b_neigh_n_h$.rope, 3)`). A model including *Group* as a main effect did not improve the predictive performance of the model ($\Delta_{ELPD}$ = `r round(exp_1_loos[2], 2)`, $SE$ = `r round(exp_1_loos[4], 2)`), indicating that participants in both groups performed equivalently. @fig-epreds-1 illustrates the posterior of the average predictions of the model for words with different values of *Cognateness* and *CLPN*.

```{r tbl-dataset}
#| label: tbl-dataset
sem <- function(x) mean(x) / (sqrt(length(x)))
# proportion adjusted from boundary values (Gelman, Hill & Vehtari, 2020)
prop_adj <- function(x, n){
    e <- (x+2)/(n+4)
    return(e)
}

# adjusted standard error of proportion (Gelman, Hill & Vehtari, 2020)
prop_adj_se <- function(x, n) {
    e <- (x+2)/(n+4)
    se <- sqrt(e*(1-e)/(n+4))
    return(se)
}

# adjusted standard error of proportion (Gelman, Hill & Vehtari, 2020)
prop_adj_ci <- function(x, n, .width = 0.95) {
    e <- (x+2)/(n+4)
    se <- sqrt(e*(1-e)/(n+4))
    ci <-  e + qnorm(c((1-.width)/2, (1-(1-.width)/2)))*se
    ci[1] <- ifelse(ci[1]<0, 0, ci[1]) # truncate at 0
    ci[2] <- ifelse(ci[2]>1, 1, ci[2]) # truncate at 1
    return(ci)
}

tbl_data <- list("Experiment 1" = dataset_1,
                 "Experiment 2" = dataset_2,
                 "Experiment 3" = dataset_3) |> 
    bind_rows(.id = "exp") |> 
    add_count(exp, group, participant_id, name = "trials") |> 
    summarise(n_trials = n(),
              correct = sum(correct),
              .by = c(group, exp, participant_id)) |> 
    mutate(correct = prop_adj(correct, n_trials)) |> 
    summarise(across(correct, lst(mean, sd, sem, min, max, list)),
              across(n_trials, lst(mean, sum, sd, min, max)),
              n_participants = n_distinct(participant_id),
              .by = c(group, exp)) |> 
    relocate(n_participants, matches("n_trials"))

tbl_data |> 
    gt(rowname_col = "group",
       groupname_col = "exp") |> 
    fmt_number(is.numeric, decimals = 2) |> 
    #gtExtras::gt_plt_dist(correct_list, type = "density") |> 
    fmt_integer(c(matches("sum|min|max"), n_participants)) |> 
    fmt_number(matches("correct"), scale_by = 100) |> 
    tab_spanner("Valid trials", matches("n_trials")) |> 
    tab_spanner("Accuracy (%)", matches("correct")) |> 
    cols_merge_range(n_trials_min, n_trials_max) |> 
    cols_merge_range(correct_min, correct_max) |> 
    cols_label(n_trials_sum = "N trials",
               n_participants = "N",
               n_trials_mean = "Mean",
               n_trials_sd = "SD",
               n_trials_min = "Range",
               correct_mean = "Mean",
               correct_sd = "SD",
               correct_sem = "SE",
               correct_min = "Range",
               correct_list = "") |> 
    tab_style(cell_text(style = "italic"),
              cells_column_labels()) |> 
    tab_style(cell_text(weight = "bold"),
              cells_column_spanners()) |> 
    tab_style(cell_text(align = "left"),
              list(cells_body(), cells_column_labels()))
```


